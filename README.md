# Malware Detection Analysis

This repository contains SQL code for analyzing malware detection data from antivirus software. The SQL code retrieves information about the latest run of each software, including the number of malware detected and the difference from the second last run.

## Introduction

In many IT environments, antivirus software plays a crucial role in detecting and mitigating malware threats. Analyzing the detection patterns of various antivirus solutions can provide insights into their effectiveness and performance over time.

This SQL script aims to analyze malware detection data captured from multiple runs of antivirus software. It identifies the latest run of each software, calculates the number of malware detected in that run, and computes the difference from the second last run. The results can help in understanding the recent detection trends and any significant changes in malware detection capabilities.

## Problem

![Day21](https://github.com/bhumikadata/Malware-Detection/assets/131578649/7b742d6c-7127-44e1-a221-82f3c1cf8872)


## SQL Code

```sql
with run_count as 
(
select 
  *,
  count(software_id) over(partition by software_id)  as cnt
from 
  malware 
)
,latest_date as 
(
select 
  *,
  malware_detected - lag(malware_detected) over(partition by software_id order by run_date) as difference_to_previous,
  max(run_date) over(partition by software_id)  as latest_run
from 
  run_count
where 
  cnt > 1   
)
select 
  software_id,
  malware_detected,
  difference_to_previous
from 
  latest_date 
where 
  run_date = latest_run and malware_detected >= 10
```


let's break down your SQL query step by step:

## Common Table Expressions (CTEs) Definitions:

### run_count: 
This CTE calculates the count of runs for each software by using the window function COUNT() OVER(PARTITION BY software_id) to count the occurrences of each software_id.

### latest_date:
This CTE selects all columns from run_count. It also calculates the difference in malware_detected between the current run and the previous run (LAG(malware_detected)), ordered by run_date, within each software_id partition. Additionally, it identifies the latest run date for each software.

## Main Query:
This main query selects columns software_id, malware_detected, and difference_to_previous from the latest_date CTE.
It filters the results to include only the rows where run_date matches the latest_run for each software (run_date = latest_run) and where malware_detected is greater than or equal to 10.

## Explanation:
The query first calculates the count of runs for each software and identifies the latest run date for each software, along with the difference in malware_detected between the latest run and the second last run.
Then, it selects the software_id, malware_detected, and difference_to_previous for the latest run of each software where the malware_detected count is at least 10.

This query provides insights into the latest malware detection statistics for each antivirus software, including any significant changes in detection between the latest and second last runs.




